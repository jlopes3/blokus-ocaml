<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>lib.ml &mdash; Coverage report</title>
    <meta name="description" content="90.91% coverage in src/lib.ml">
    <link rel="stylesheet" href="../coverage.css"/>
    <script src="../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../index.html">
          <span class="dirname">src/</span>lib.ml
        </a>
      </h1>
      <h2>90.91%</h2>
    </div>
    <div id="navbar">
      <span class="some-visited" style="top:20.79%"></span>
      <span class="unvisited" style="bottom:36.88%"></span>
      <span class="unvisited" style="bottom:10.89%"></span>
      <span class="unvisited" style="bottom:10.64%"></span>
      <span class="unvisited" style="bottom:3.47%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span > </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span > </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span > </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span > </span>
<a id="L29"></a><span > </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span > </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span > </span>
<a id="L34"></a><span > </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span > </span>
<a id="L38"></a><span > </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span class="visited"> </span>
<a id="L43"></a><span class="visited"> </span>
<a id="L44"></a><span class="visited"> </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span class="visited"> </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span class="visited"> </span>
<a id="L51"></a><span class="visited"> </span>
<a id="L52"></a><span > </span>
<a id="L53"></a><span > </span>
<a id="L54"></a><span class="visited"> </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span > </span>
<a id="L57"></a><span > </span>
<a id="L58"></a><span > </span>
<a id="L59"></a><span > </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span > </span>
<a id="L64"></a><span > </span>
<a id="L65"></a><span class="visited"> </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span > </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span > </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span > </span>
<a id="L78"></a><span > </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span > </span>
<a id="L83"></a><span > </span>
<a id="L84"></a><span class="some-visited"> </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span > </span>
<a id="L87"></a><span > </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span > </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span > </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span > </span>
<a id="L99"></a><span > </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span > </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span > </span>
<a id="L104"></a><span > </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span > </span>
<a id="L107"></a><span > </span>
<a id="L108"></a><span > </span>
<a id="L109"></a><span > </span>
<a id="L110"></a><span > </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span > </span>
<a id="L113"></a><span > </span>
<a id="L114"></a><span > </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span class="visited"> </span>
<a id="L117"></a><span class="visited"> </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span > </span>
<a id="L120"></a><span > </span>
<a id="L121"></a><span > </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span > </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span > </span>
<a id="L128"></a><span > </span>
<a id="L129"></a><span > </span>
<a id="L130"></a><span > </span>
<a id="L131"></a><span > </span>
<a id="L132"></a><span > </span>
<a id="L133"></a><span > </span>
<a id="L134"></a><span > </span>
<a id="L135"></a><span > </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span > </span>
<a id="L139"></a><span > </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span > </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span > </span>
<a id="L149"></a><span > </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span > </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span > </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span > </span>
<a id="L157"></a><span > </span>
<a id="L158"></a><span > </span>
<a id="L159"></a><span > </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span > </span>
<a id="L163"></a><span > </span>
<a id="L164"></a><span > </span>
<a id="L165"></a><span > </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span > </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span > </span>
<a id="L172"></a><span > </span>
<a id="L173"></a><span > </span>
<a id="L174"></a><span > </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span > </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span > </span>
<a id="L179"></a><span > </span>
<a id="L180"></a><span > </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span > </span>
<a id="L187"></a><span > </span>
<a id="L188"></a><span > </span>
<a id="L189"></a><span > </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span > </span>
<a id="L194"></a><span > </span>
<a id="L195"></a><span > </span>
<a id="L196"></a><span > </span>
<a id="L197"></a><span > </span>
<a id="L198"></a><span > </span>
<a id="L199"></a><span > </span>
<a id="L200"></a><span > </span>
<a id="L201"></a><span > </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span > </span>
<a id="L204"></a><span > </span>
<a id="L205"></a><span > </span>
<a id="L206"></a><span > </span>
<a id="L207"></a><span > </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span > </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span class="visited"> </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span > </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span class="visited"> </span>
<a id="L217"></a><span > </span>
<a id="L218"></a><span > </span>
<a id="L219"></a><span > </span>
<a id="L220"></a><span class="visited"> </span>
<a id="L221"></a><span class="visited"> </span>
<a id="L222"></a><span class="visited"> </span>
<a id="L223"></a><span > </span>
<a id="L224"></a><span > </span>
<a id="L225"></a><span class="visited"> </span>
<a id="L226"></a><span > </span>
<a id="L227"></a><span > </span>
<a id="L228"></a><span > </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span > </span>
<a id="L233"></a><span > </span>
<a id="L234"></a><span > </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span > </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span > </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span class="visited"> </span>
<a id="L244"></a><span class="visited"> </span>
<a id="L245"></a><span > </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span class="visited"> </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span class="visited"> </span>
<a id="L252"></a><span class="visited"> </span>
<a id="L253"></a><span class="visited"> </span>
<a id="L254"></a><span class="visited"> </span>
<a id="L255"></a><span class="unvisited"> </span>
<a id="L256"></a><span class="visited"> </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span > </span>
<a id="L259"></a><span class="visited"> </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span > </span>
<a id="L262"></a><span > </span>
<a id="L263"></a><span > </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span > </span>
<a id="L266"></a><span > </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span > </span>
<a id="L270"></a><span > </span>
<a id="L271"></a><span > </span>
<a id="L272"></a><span > </span>
<a id="L273"></a><span > </span>
<a id="L274"></a><span class="visited"> </span>
<a id="L275"></a><span class="visited"> </span>
<a id="L276"></a><span class="visited"> </span>
<a id="L277"></a><span class="visited"> </span>
<a id="L278"></a><span > </span>
<a id="L279"></a><span > </span>
<a id="L280"></a><span class="visited"> </span>
<a id="L281"></a><span > </span>
<a id="L282"></a><span > </span>
<a id="L283"></a><span class="visited"> </span>
<a id="L284"></a><span class="visited"> </span>
<a id="L285"></a><span class="visited"> </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span > </span>
<a id="L288"></a><span > </span>
<a id="L289"></a><span > </span>
<a id="L290"></a><span > </span>
<a id="L291"></a><span > </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span > </span>
<a id="L294"></a><span > </span>
<a id="L295"></a><span > </span>
<a id="L296"></a><span > </span>
<a id="L297"></a><span > </span>
<a id="L298"></a><span > </span>
<a id="L299"></a><span class="visited"> </span>
<a id="L300"></a><span > </span>
<a id="L301"></a><span > </span>
<a id="L302"></a><span class="visited"> </span>
<a id="L303"></a><span class="visited"> </span>
<a id="L304"></a><span class="visited"> </span>
<a id="L305"></a><span > </span>
<a id="L306"></a><span > </span>
<a id="L307"></a><span class="visited"> </span>
<a id="L308"></a><span class="visited"> </span>
<a id="L309"></a><span class="visited"> </span>
<a id="L310"></a><span > </span>
<a id="L311"></a><span > </span>
<a id="L312"></a><span class="visited"> </span>
<a id="L313"></a><span > </span>
<a id="L314"></a><span > </span>
<a id="L315"></a><span > </span>
<a id="L316"></a><span > </span>
<a id="L317"></a><span > </span>
<a id="L318"></a><span > </span>
<a id="L319"></a><span > </span>
<a id="L320"></a><span > </span>
<a id="L321"></a><span > </span>
<a id="L322"></a><span > </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span > </span>
<a id="L325"></a><span class="visited"> </span>
<a id="L326"></a><span > </span>
<a id="L327"></a><span > </span>
<a id="L328"></a><span class="visited"> </span>
<a id="L329"></a><span > </span>
<a id="L330"></a><span class="visited"> </span>
<a id="L331"></a><span > </span>
<a id="L332"></a><span > </span>
<a id="L333"></a><span class="visited"> </span>
<a id="L334"></a><span class="visited"> </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span > </span>
<a id="L337"></a><span class="visited"> </span>
<a id="L338"></a><span > </span>
<a id="L339"></a><span > </span>
<a id="L340"></a><span class="visited"> </span>
<a id="L341"></a><span > </span>
<a id="L342"></a><span > </span>
<a id="L343"></a><span > </span>
<a id="L344"></a><span > </span>
<a id="L345"></a><span > </span>
<a id="L346"></a><span > </span>
<a id="L347"></a><span > </span>
<a id="L348"></a><span > </span>
<a id="L349"></a><span > </span>
<a id="L350"></a><span class="visited"> </span>
<a id="L351"></a><span > </span>
<a id="L352"></a><span > </span>
<a id="L353"></a><span > </span>
<a id="L354"></a><span > </span>
<a id="L355"></a><span > </span>
<a id="L356"></a><span > </span>
<a id="L357"></a><span > </span>
<a id="L358"></a><span > </span>
<a id="L359"></a><span > </span>
<a id="L360"></a><span class="unvisited"> </span>
<a id="L361"></a><span class="unvisited"> </span>
<a id="L362"></a><span > </span>
<a id="L363"></a><span > </span>
<a id="L364"></a><span class="visited"> </span>
<a id="L365"></a><span > </span>
<a id="L366"></a><span > </span>
<a id="L367"></a><span > </span>
<a id="L368"></a><span class="visited"> </span>
<a id="L369"></a><span > </span>
<a id="L370"></a><span > </span>
<a id="L371"></a><span > </span>
<a id="L372"></a><span class="visited"> </span>
<a id="L373"></a><span class="visited"> </span>
<a id="L374"></a><span class="visited"> </span>
<a id="L375"></a><span class="visited"> </span>
<a id="L376"></a><span class="visited"> </span>
<a id="L377"></a><span class="visited"> </span>
<a id="L378"></a><span class="visited"> </span>
<a id="L379"></a><span > </span>
<a id="L380"></a><span > </span>
<a id="L381"></a><span class="visited"> </span>
<a id="L382"></a><span class="visited"> </span>
<a id="L383"></a><span class="visited"> </span>
<a id="L384"></a><span > </span>
<a id="L385"></a><span > </span>
<a id="L386"></a><span class="visited"> </span>
<a id="L387"></a><span > </span>
<a id="L388"></a><span > </span>
<a id="L389"></a><span > </span>
<a id="L390"></a><span class="unvisited"> </span>
<a id="L391"></a><span > </span>
<a id="L392"></a><span > </span>
<a id="L393"></a><span > </span>
<a id="L394"></a><span > </span>
<a id="L395"></a><span > </span>
<a id="L396"></a><span > </span>
<a id="L397"></a><span > </span>
<a id="L398"></a><span > </span>
<a id="L399"></a><span > </span>
<a id="L400"></a><span > </span>
<a id="L401"></a><span > </span>
<a id="L402"></a><span > </span>
<a id="L403"></a><span > </span>
<a id="L404"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
</pre>
<pre><code class="ocaml">(*

FPSE Assignment 4
 
Name                  : Jonathon Lopes
List of Collaborators :

*)

open Core


(*
  In this assignment you will implement a simple n-gram model.  We will also give you some template code to give you a basis for an elegant and general library for modeling n-grams.

  Part I consists of these library routines, and Part II will be to develop a command-line tool to build and use an n-gram model which makes use of your library.

  Using the n-gram model of sequences and probabilities, we'll take in some sequence of items, and then use it as a basis to generate more similar sequences (for example, sentences of words, lists of numbers, etc.), or evaluate the likelihood of seeing particular sequences.

  First we need some helper functions and definitions.

*)

(* Part I consists of the following 6 Exercises *)

(*
  Exercise 1:

  Given a list of some type, and a positive integer `n`, produce a list of contiguous subsequences of length `n` of the original list. If `n` is greater than the length of the input, return an empty list.

  E.G.
    chunks 3 [1; 2; 3; 4; 5] =
      [ [1;2;3]; [2;3;4]; [3;4;5] ]

    chunks 2 ["a"; "b"; "c"; "d"; "e"] =
      [ ["a";"b"]; ["b";"c"]; ["c";"d"]; ["d";"e"] ]

      chunks 3 [1; 2] = []
    else if (length &gt; List.length total) then []
*)
let rec list_section_helper (start: int) (length: int) (curr: int) (total: 'a list): 'b list =
  <span data-count="234">i</span>f (curr &gt; (start + length - 1)) then <span data-count="37">[</span>]
  else <span data-count="197">i</span>f (curr &gt; (start - 1)) then <span data-count="101">(</span>List.nth_ex<span data-count="101">n</span> total curr) :: list_section_helpe<span data-count="101">r</span> start length (curr + 1) (total)
  else <span data-count="96">l</span>ist_section_helper start length (curr + 1) (total);;

let list_section (start: int) (length: int) (total: 'b list): 'b list =
  <span data-count="37">l</span>ist_section_helper start length 0 total;;

let rec chunks_helper (n: int) (index: int) (l: 'a list): 'a list list =
  <span data-count="46">i</span>f (index &gt; ((List.lengt<span data-count="46">h</span> l) - n)) then <span data-count="9">[</span>]
  else <span data-count="37">(</span>list_sectio<span data-count="37">n</span> index n l) :: chunks_helpe<span data-count="37">r</span> n (index + 1) l;; 

let chunks (n: int) (l: 'a list): 'a list list =
  <span data-count="9">c</span>hunks_helper n 0 l;;

(*
  Exercise 2:

  Given a non-empty list of some type, return a pair of the last element, and a list of all previous elements. This should take O(n) time.

  E.G.
    split_last [1;2;3] = (3, [1;2])
*)
let split_last (l: 'a list): 'a * 'a list =
  <span data-count="33">(</span>List.hd_ex<span data-count="33">n</span> (List.re<span data-count="33">v</span> l), List.re<span data-count="33">v</span> (List.tl_ex<span data-count="33">n</span> (List.re<span data-count="33">v</span> l)));;


(*
Exercise 3:

Here we will make a generic method for making map keys which are lists of some underlying element. 

Given a data type module Elt which can be used as the key for a map (Map.Key module type in Core), fill in the following functor to make a map key data type module for a *list* of Elt's.  
Recall that the Map.Key module type needs 
a type `t`, 
a `compare` on it 
and the to/from s-expression conversions over `t`
: https://ocaml.org/p/core/v0.15.0/doc/Core/Map_intf/module-type-Key/index.html.
*)
module List_key (Elt: Map.Key): (Map.Key with type t = Elt.t list) = struct
  (*
  ... YOUR IMPLEMENTATION HERE ... 
  *)
  <span data-count="0">t</span>ype t = <span data-count="182">E</span>lt.t <span data-count="140">l</span>ist [@@deriving compare, sexp]
end

(*
We will need randomness for this code, which can make things hard to test. To make it repeatable, we will abstract away the randomizer as another parameter, of module type `Randomness`.

Note that the standard `Core.Random` module is compatible with this module type, but you could also provide alternative definitions which are deterministic, give more debug info, guarantee a certain sequence of numbers, log to stderr, etc.
*)
module type Randomness = sig
  (*
  Given a maximum integer value, return a pseudorandom integer from 0 (inclusive) to this value (exclusive).
  *)
  val int : int -&gt; int
end

(*
Exercise 4:

Given a multiset aka bag, select one element from it with uniform probability (i.e. so that elements which appear multiple times should have a higher chance to be picked). Or, if the bag is empty, return None.
  
  See the (weighted) reservoir sampling algorithms for a simple potential approach to this.
  
  Use `Core.Bag` for your bag. This operation should not be destructive or mutate the bag, it should just extract a random element. Be aware that Core.Bag is a mutable data structure.  Also be aware of the `'a Bag.Elt.t` type, which signifies a particular element within the Bag (distinguishing it from other, possibly equal elements).
  
  Several Bag functions take and return `'a Bag.Elt.t` values so look at the documentation for `Bag.Elt` to see how to e.g. extract the underlying value.
  
  Note that `Bag.choose` does *not* satisfy this definition;  it simply picks the first element always.
  
  Note we use a shorthand notation for first-class modules not covered in lecture: the parameter R here is a first-class module which has already been unpacked from value-space to module-space.  Similarly, sample can be invoked as e.g. `sample (module Random) ...`
  
  *)
  let sample (module R: Randomness) (b: 'a Bag.t): 'a option =
    <span data-count="15">i</span>f (Core.Bag.lengt<span data-count="15">h</span> b = 0) then <span data-count="1">N</span>one 
    else <span data-count="14">S</span>ome(List.nth_ex<span data-count="14">n</span> (Core.Bag.to_lis<span data-count="14">t</span> b) (R.in<span data-count="14">t</span> (Core.Bag.lengt<span data-count="14">h</span> b)));;
    
    (* Exercise 5:
    
    Fill out the skeleton of the module N_grams below to make a common probabilistic model of sequences, the n-gram model, also called the Markov model.
    
    The general intuition is simple: if we want to be able to predict what comes next in a sequence of items, we can probably do so on the basis of the elements which preceeded it. Moreover, we can 
      probably ignore parts of the sequence which came _far_ before the element we want to predict, and focus our attention on the immediately previous couple of items.
    
    Consider sentences of words in english text, a very common type of sequence to apply this approach to. If we are given that the word we want to predict came after:
    
    "take this boat for a spin out on the" ???
    
    Then we could say that "water" is more likely than "town" to follow. If we have less context, say only 2 words:
    
    "on the" ???
    
    We will naturally make a poorer approximation of the true distribution, but it may be sufficient for some purposes anyway, and will be easier to estimate.  How can we estimate the actual distribution of words efficiently, then?
    
    We will need to take in some observed sequence of words or tokens, called a _corpus_.  Let's say we want to keep 2 words of context when predicting what comes next, based on the provided corpus. Then we can 
    just keep track of every 3-tuple of consecutive words in the input, and count how often they appear.
    
    For example, say we observe the triples
    
    ("take", "this", "boat"), ("this", "boat", "for"), ... ("on", "the", "water").
    
    Then, if we index these properly, we can predict what should follow ("on", "the") by just sampling randomly from among all the tuples which started with that prefix, and using the last element of the tuple as our prediction.  Naturally, words which appear more frequently in the context specified should then be given more weight, and words which do not appear in our corpus after the given sequence will not be chosen at all, so our prediction should be a reasonable estimate for the empirical distribution.
      
      If we instead count 5-tuples rather than 3-tuples, we can make better predictions with the greater context, which will then more closely match the true sequence properties. However, we will also be able to observe fewer unique 5-tuples overall than 3-tuples, which will mean we need greater amounts of data to properly use a larger n-gram size.
      
      
      Feel free to read these useful resources to better understand n-grams:
      - https://blog.xrds.acm.org/2017/10/introduction-n-grams-need/
      - https://web.stanford.edu/~jurafsky/slp3/slides/LM_4.pdf
      - https://medium.com/mti-technology/n-gram-language-model-b7c2fc322799
      
      
      First define a module which holds our main functionality specific to a particular orderable type we'll call `Token`. These tokens could be words (strings) of course, but could also be numbers, or DNA base pairs, etc.
      
      We also need randomness here, so we will abstract over it as well.
      *)
      module N_grams (Random: Randomness) (Token: Map.Key) = struct
        
        (*
        Define a module which is a Map satisfying the signature provided, so that sequences of tokens can be mapped to values.
        *)
        module Token_list_map : (Map.S with type Key.t = Token.t list) = Map.Make(List_key(Token));;
        (* remove ;; and fill in *)
        
        (*
        Based on how n-grams work, we will represent a probability distribution as mapping from prefixes of size `n`, to tokens which followed this prefix in our training corpus. The more times any particular token follows a prefix, the more likely it is to follow it again.
        
        Don't change this type; it is a map from token lists to bags of tokens.
        *)
        type distribution = (Token.t Bag.t) Token_list_map.t
        
        (*
        Given a positive integer `n` and a list of tokens, add each token to a new distribution as an element of the set corresponding to the (n-1)-gram which preceeds it.
        
        e.g. (informally diagramming the map/bag of a `distribution`)
        
        ngrams 2 [1; 2; 3; 4; 4; 4; 2; 2; 3; 1] =
        { 
          [1] -&gt; {2}; 
          [2] -&gt; {3; 2; 3};
          [3] -&gt; {4; 1};
          [4] -&gt; {4; 4; 2};
          |        |
          |        \------- ...was followed by each of these elements
          \-- this sequence (of length 1 in this example of 2-grams)  ...
          }
          
          ngrams 3 [1; 2; 3; 4; 4; 4; 2; 2; 3; 1] =
          {
            [1; 2] -&gt; {3};
            [2; 3] -&gt; {4; 1};
            [3; 4] -&gt; {4};
            [4; 4] -&gt; {4; 2};
            [4; 2] -&gt; {2};
            [2; 2] -&gt; {3};
            |        |
            |        \------- ...was followed by each of these elements
            \-- this sequence...
            }
            
            ngrams 1 [1; 2; 3; 4; 4; 4; 2; 2; 3; 1] =
            {
              [] -&gt; {1; 2; 3; 4; 4; 4; 2; 2; 3; 1};
              |        |
              |        \------- ...was followed by each of these elements
              \-- this sequence...
              }
              *)

              let get_first (pair: 'a * 'b): 'a =
                <span data-count="30">l</span>et (r1, _) = pair in
                  r1;;
              
              let get_second (pair: 'a * 'b): 'b =
                <span data-count="60">l</span>et (_, r2) = pair in
                  r2;;
              
              let add_to_map (map: (Token.t Bag.t) Token_list_map.t) (pair: Token.t * Token.t list): (Token.t Bag.t) Token_list_map.t = 
                <span data-count="30">m</span>atch (Map.find map (get_secon<span data-count="30">d</span> pair)) with
                | <span data-count="6">S</span>ome(value) -&gt; Map.set map ~key:(get_secon<span data-count="6">d</span> pair) ~data:(Bag.of_lis<span data-count="6">t</span>((Bag.to_lis<span data-count="6">t</span> value) @ [(get_firs<span data-count="6">t</span> pair)]))
                | <span data-count="24">N</span>one -&gt; Map.set map ~key:(get_secon<span data-count="24">d</span> pair) ~data:(Bag.of_lis<span data-count="24">t</span> [(get_firs<span data-count="24">t</span> pair)]);;
                
              let ngrams (n: int) (l: Token.t list): distribution =
                <span data-count="6">L</span>ist.fold ~f:(add_to_map) ~init:(Token_list_map.empty) (List.ma<span data-count="6">p</span> ~f:(split_last) (chunk<span data-count="6">s</span> n l));;
 
                
                (*
                
                Now, we can use the output of `ngrams` to create new, randomly sampled sequences.
                
                The arguments it expects are as follows:
                - an output from a call to `ngrams n` (above) representing a distribution
                - an integer for the maximum length of sequence to generate
                - a list of tokens (of length `n-1`) to kick off the random generation and sequence (consider it a 'seed' to look up in the distribution)
                
                It will then produce a sequence which is distributed according to the n-gram model it is given, terminating if either the resulting sequence reaches the maximum length, or when there are no observed
                  n-grams which could follow.
                
                *)

                let rec last_m_list_helper (count: int) (data: 'a list) (m: int) : 'a list =
                  <span data-count="36">i</span>f (Int.equal (count - 1) m) then <span data-count="14">[</span>]
                  else <span data-count="22">(</span>last_m_list_helpe<span data-count="22">r</span> (count + 1) data m) @ [List.nth_ex<span data-count="22">n</span> data ((List.lengt<span data-count="22">h</span> data) - count)];;

                (* Precondition: m &lt;= data length *)
                let last_m_list (data: 'a list) (m: int) : 'a list =
                  <span data-count="14">l</span>ast_m_list_helper 1 data m;;
                
                let rec sample_sequence_helper (dist: distribution) (max_length: int) (curr_ngram: Token.t list) (n: int): Token.t list =
                  <span data-count="18">i</span>f (Int.equal (List.lengt<span data-count="18">h</span> (curr_ngram)) max_length) then <span data-count="4">c</span>urr_ngram
                  else <span data-count="14">m</span>atch Map.find dist (last_m_lis<span data-count="14">t</span> curr_ngram n) with
                  | <span data-count="3">N</span>one -&gt; curr_ngram
                  | <span data-count="11">S</span>ome(bag) -&gt; match sample (module Random) bag with
                    | <span data-count="0">N</span>one -&gt; curr_ngram (* unreachable *)
                    | <span data-count="11">S</span>ome(value) -&gt; sample_sequence_helper (dist) (max_length) (curr_ngram @ [value]) n;;

                let sample_sequence (dist: distribution) ~(max_length: int) ~(initial_ngram: Token.t list): Token.t list =
                  <span data-count="7">s</span>ample_sequence_helper dist max_length (initial_ngram) (List.lengt<span data-count="7">h</span> initial_ngram);;
                  
                end (* of module N_grams *)
                
(*
Exercise 6:

Given a string, perform basic sanitization/normalization by taking the following steps:

- remove all characters not in the range [a-zA-Z0-9]
- convert all characters [A-Z] to lowercase

if the resulting string is empty, return None.
*)
let rec remove_nonalphanumeric_helper (input: string) (curr: int): string =
  <span data-count="47">i</span>f (Int.equal (String.lengt<span data-count="47">h</span> input) (curr)) then <span data-count="15">"</span>"
  else <span data-count="32">i</span>f (Char.to_in<span data-count="32">t</span> input.[curr] &gt; 47 &amp;&amp; <span data-count="23">C</span>har.to_in<span data-count="23">t</span> input.[curr] &lt; 58) then <span data-count="2">(</span>(Char.to_strin<span data-count="2">g</span> input.[curr]) ^ remove_nonalphanumeric_helpe<span data-count="2">r</span> input (curr + 1))
  else <span data-count="30">i</span>f (Char.to_in<span data-count="30">t</span> input.[curr] &gt; 96 &amp;&amp; <span data-count="21">C</span>har.to_in<span data-count="21">t</span> input.[curr] &lt; 122) then <span data-count="21">(</span>(Char.to_strin<span data-count="21">g</span> input.[curr]) ^ remove_nonalphanumeric_helpe<span data-count="21">r</span> input (curr + 1))
  else <span data-count="9">r</span>emove_nonalphanumeric_helper input (curr + 1);;
  
let remove_nonalphanumeric (s: string): string =
  <span data-count="15">r</span>emove_nonalphanumeric_helper (String.lowercas<span data-count="15">e</span> s) 0;;
  
let sanitize (s: string): string option =
  <span data-count="15">m</span>atch remove_nonalphanumeric s with
  | <span data-count="2">"</span>" -&gt; None
  | <span data-count="13">r</span>es -&gt; Some (res);;       

  (* See ngrams.ml for part II.
  
  For any auxiliary functions needed in part II, put them here so they can
  be unit tested.  
  *)


(* Make a string from the file contents 
let make_string_from_file (file : string) : string = file |&gt; In_channel.read_all;;
*)

(* Make a string into a list of strings *)
let make_list_from_string (curr: string) : string list = <span data-count="3">c</span>urr |&gt; String.split_on_chars ~on: (['\t'; '\r'; '\n'; ' '; '\x0C']);;

let option_to_bool (input: string option) : bool =
  <span data-count="12">m</span>atch input with
  | <span data-count="10">S</span>ome(_) -&gt; true
  | <span data-count="2">N</span>one -&gt; false;;

let option_to_no_option (input: string option) : string =
  <span data-count="11">m</span>atch input with
  | <span data-count="10">S</span>ome(x) -&gt; x
  | <span data-count="1">N</span>one -&gt; "";; (* should be unreachable *)

let sanitize_all (strings : string list) : string list =
  <span data-count="5">L</span>ist.map ~f:(option_to_no_option) (List.filte<span data-count="5">r</span> ~f:(option_to_bool) (List.ma<span data-count="5">p</span> ~f:(sanitize) (strings)));;

  (*
  let file_to_sanitized_list (filename : string) : string list =
    make_string_from_file filename
    |&gt; make_list_from_string
    |&gt; sanitize_all;;
    *)
            

  (* SAMPLE CHOICE *)
  module SGrams = N_grams (Core.Random) (String)

  let add_to_string (input: string) (input2: string): string = <span data-count="5">i</span>nput ^ " " ^ input2;;

  let remove_first_char (inputString: string): string =
    <span data-count="2">S</span>tring.sub inputString ~pos:(1) ~len:(String.lengt<span data-count="2">h</span> inputString - 1);;

  let list_to_string (input: string list) : string = <span data-count="2">r</span>emove_first_char (List.fol<span data-count="2">d</span> ~f:(add_to_string) ~init:("") input);;

  let rec last_m_list_helper (count: int) (data: 'a list) (m: int) : 'a list =
    <span data-count="7">i</span>f (Int.equal (count - 1) m) then <span data-count="2">[</span>]
    else <span data-count="5">(</span>last_m_list_helpe<span data-count="5">r</span> (count + 1) data m) @ [List.nth_ex<span data-count="5">n</span> data ((List.lengt<span data-count="5">h</span> data) - count)];;

  let last_m_list (data: 'a list) (m: int) : 'a list =
    <span data-count="2">l</span>ast_m_list_helper 1 data m;;

  let first_m_list (data: 'a list) (m: int) : 'a list =
    <span data-count="2">L</span>ist.rev (last_m_lis<span data-count="2">t</span> (List.re<span data-count="2">v</span> data) m);;
    
    

(* Sample choicee if initial ngram is given 
  let sample_choice_initial (n: int) (input_file: string list) (sample_length: int) (initial_ngram: string list) =
    print_endline (list_to_string (first_m_list initial_ngram ((List.length initial_ngram) - n + 1) @ (SGrams.sample_sequence (SGrams.ngrams n input_file) ~max_length:(sample_length - (List.length initial_ngram) + n - 1) ~initial_ngram:(last_m_list initial_ngram (n - 1)))));;
    *)
        
  let random_ngram_start (key_list: string list list) : string list =
    <span data-count="1">L</span>ist.nth_exn key_list (Core.Random.in<span data-count="1">t</span> (List.lengt<span data-count="1">h</span> key_list));;
  
(* Sample choice if initial ngram is not given
  let sample_choice_no_initial (n: int) (input_file: string list) (sample_length: int) =
    print_endline (list_to_string (SGrams.sample_sequence (SGrams.ngrams n input_file) ~max_length:sample_length ~initial_ngram:(random_ngram_start (Map.keys (SGrams.ngrams n input_file)))));;
    *)
  

    
  (* MOST FREQUENT *)
  <span data-count="0">t</span>ype result = { ngram : <span data-count="0">s</span>tring lis<span data-count="0">t</span>; frequency : <span data-count="0">i</span>n<span data-count="0">t</span>} [@@deriving to_yojson];;
  <span data-count="0">t</span>ype result_list = <span data-count="0">r</span>esult lis<span data-count="0">t</span> [@@deriving to_yojson];;

  let get_first (pair: 'a * 'b): 'a =
    <span data-count="10">l</span>et (r1, _) = pair in
      r1;;
  
  let get_second (pair: 'a * 'b): 'b =
    <span data-count="26">l</span>et (_, r2) = pair in
      r2;;
  
  let rec compare_string_lists (first: string list) (second: string list): int = 
    <span data-count="8">m</span>atch (first, second) with
    | <span data-count="1">[</span>], [] -&gt; 0
    | <span data-count="1">[</span>],_ -&gt; -1
    | <span data-count="1">_</span>,[] -&gt; 1
    | <span data-count="5">(</span>h1::t1), (h2::t2) -&gt; if ((String.compar<span data-count="5">e</span> h1 h2) &gt; 0) then <span data-count="1">1</span>
                          else <span data-count="4">i</span>f (String.equal h1 h2) then <span data-count="3">c</span>ompare_string_lists t1 t2
                          else  <span data-count="1">-</span>1;;

  let compare_frequency_pairs (pair1: string list * int) (pair2: string list * int): int =
    <span data-count="7">i</span>f (get_secon<span data-count="7">d</span> pair1) &gt; (get_secon<span data-count="7">d</span> pair2) then <span data-count="1">1</span>
    else <span data-count="6">i</span>f (get_secon<span data-count="6">d</span> pair1) &lt; (get_secon<span data-count="6">d</span> pair2) then <span data-count="1">-</span>1
    else <span data-count="5">c</span>ompare_string_lists (get_firs<span data-count="5">t</span> pair1) (get_firs<span data-count="5">t</span> pair2);;

  let first_elements (n_most_frequent: int) (input: 'a list) : 'a list =
    <span data-count="2">L</span>ist.filteri ~f:(fun index -&gt; fun _a -&gt; <span data-count="10">(</span>index &lt; n_most_frequent)) input;;

  (* Make a list of records from keyword counts *)
  let make_record_list (currList: (string list * int) list) : result_list = 
    <span data-count="0">L</span>ist.map ~f:(fun elt -&gt; <span data-count="0">{</span> ngram = (get_firs<span data-count="0">t</span> elt); frequency = (get_secon<span data-count="0">d</span> elt)}) currList;;

    (*
    let most_frequent (n: int) (input_file: string list) (n_most_frequent: int) =
      (SGrams.ngrams n input_file)
      |&gt; Map.to_alist
      |&gt; List.map ~f:(fun pair -&gt; ((get_first pair), Bag.length (get_second pair)))
      |&gt; List.sort ~compare:(compare_frequency_pairs)
      |&gt; List.rev
      |&gt; first_elements n_most_frequent
      |&gt; make_record_list
      |&gt; result_list_to_yojson
      |&gt; Yojson.Safe.to_string
      |&gt; print_endline;;
      *)
</code></pre>
      </div>
    </div>
    <script src="../coverage.js"></script>
  </body>
</html>
