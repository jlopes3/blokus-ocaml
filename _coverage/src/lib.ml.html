<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>lib.ml &mdash; Coverage report</title>
    <meta name="description" content="81.14% coverage in src/lib.ml">
    <link rel="stylesheet" href="../coverage.css"/>
    <script src="../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../index.html">
          <span class="dirname">src/</span>lib.ml
        </a>
      </h1>
      <h2>81.14%</h2>
    </div>
    <div id="navbar">
      <span class="unvisited" style="top:11.94%"></span>
      <span class="some-visited" style="top:25.68%"></span>
      <span class="some-visited" style="top:33.56%"></span>
      <span class="some-visited" style="top:39.19%"></span>
      <span class="some-visited" style="top:40.99%"></span>
      <span class="some-visited" style="top:48.87%"></span>
      <span class="unvisited" style="bottom:48.87%"></span>
      <span class="some-visited" style="bottom:42.34%"></span>
      <span class="unvisited" style="bottom:39.19%"></span>
      <span class="unvisited" style="bottom:36.04%"></span>
      <span class="unvisited" style="bottom:33.78%"></span>
      <span class="unvisited" style="bottom:33.56%"></span>
      <span class="some-visited" style="bottom:29.28%"></span>
      <span class="some-visited" style="bottom:28.15%"></span>
      <span class="some-visited" style="bottom:22.30%"></span>
      <span class="unvisited" style="bottom:21.85%"></span>
      <span class="unvisited" style="bottom:20.50%"></span>
      <span class="unvisited" style="bottom:20.05%"></span>
      <span class="unvisited" style="bottom:19.37%"></span>
      <span class="unvisited" style="bottom:19.14%"></span>
      <span class="unvisited" style="bottom:18.92%"></span>
      <span class="unvisited" style="bottom:15.99%"></span>
      <span class="unvisited" style="bottom:15.77%"></span>
      <span class="unvisited" style="bottom:15.54%"></span>
      <span class="unvisited" style="bottom:14.86%"></span>
      <span class="unvisited" style="bottom:14.19%"></span>
      <span class="unvisited" style="bottom:13.96%"></span>
      <span class="unvisited" style="bottom:13.74%"></span>
      <span class="unvisited" style="bottom:12.84%"></span>
      <span class="unvisited" style="bottom:12.61%"></span>
      <span class="some-visited" style="bottom:11.49%"></span>
      <span class="some-visited" style="bottom:11.04%"></span>
      <span class="unvisited" style="bottom:10.59%"></span>
      <span class="some-visited" style="bottom:6.53%"></span>
      <span class="some-visited" style="bottom:6.31%"></span>
      <span class="unvisited" style="bottom:3.60%"></span>
      <span class="unvisited" style="bottom:1.35%"></span>
      <span class="unvisited" style="bottom:1.13%"></span>
      <span class="unvisited" style="bottom:0.45%"></span>
      <span class="unvisited" style="bottom:0.23%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span class="visited"> </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span class="visited"> </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span class="visited"> </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span class="visited"> </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span class="visited"> </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span class="visited"> </span>
<a id="L26"></a><span class="visited"> </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span > </span>
<a id="L29"></a><span class="visited"> </span>
<a id="L30"></a><span class="visited"> </span>
<a id="L31"></a><span class="visited"> </span>
<a id="L32"></a><span class="visited"> </span>
<a id="L33"></a><span class="visited"> </span>
<a id="L34"></a><span class="visited"> </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span > </span>
<a id="L38"></a><span class="visited"> </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span class="visited"> </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span > </span>
<a id="L43"></a><span class="visited"> </span>
<a id="L44"></a><span class="visited"> </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span class="visited"> </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span class="visited"> </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span > </span>
<a id="L53"></a><span class="unvisited"> </span>
<a id="L54"></a><span > </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span > </span>
<a id="L57"></a><span > </span>
<a id="L58"></a><span > </span>
<a id="L59"></a><span class="visited"> </span>
<a id="L60"></a><span class="visited"> </span>
<a id="L61"></a><span class="visited"> </span>
<a id="L62"></a><span class="visited"> </span>
<a id="L63"></a><span class="visited"> </span>
<a id="L64"></a><span class="visited"> </span>
<a id="L65"></a><span > </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span class="visited"> </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span class="visited"> </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span > </span>
<a id="L74"></a><span class="visited"> </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span class="visited"> </span>
<a id="L77"></a><span > </span>
<a id="L78"></a><span > </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span class="visited"> </span>
<a id="L82"></a><span class="visited"> </span>
<a id="L83"></a><span class="visited"> </span>
<a id="L84"></a><span > </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span > </span>
<a id="L87"></a><span > </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span class="visited"> </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span > </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span > </span>
<a id="L99"></a><span > </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span class="visited"> </span>
<a id="L102"></a><span class="visited"> </span>
<a id="L103"></a><span class="visited"> </span>
<a id="L104"></a><span class="visited"> </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span > </span>
<a id="L107"></a><span > </span>
<a id="L108"></a><span class="visited"> </span>
<a id="L109"></a><span class="visited"> </span>
<a id="L110"></a><span class="visited"> </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span > </span>
<a id="L113"></a><span > </span>
<a id="L114"></a><span class="some-visited"> </span>
<a id="L115"></a><span class="visited"> </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span class="visited"> </span>
<a id="L120"></a><span class="visited"> </span>
<a id="L121"></a><span class="visited"> </span>
<a id="L122"></a><span class="visited"> </span>
<a id="L123"></a><span class="visited"> </span>
<a id="L124"></a><span class="visited"> </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span class="visited"> </span>
<a id="L128"></a><span class="visited"> </span>
<a id="L129"></a><span class="visited"> </span>
<a id="L130"></a><span class="visited"> </span>
<a id="L131"></a><span class="visited"> </span>
<a id="L132"></a><span class="visited"> </span>
<a id="L133"></a><span > </span>
<a id="L134"></a><span > </span>
<a id="L135"></a><span > </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span class="visited"> </span>
<a id="L139"></a><span > </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span class="visited"> </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span > </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span class="visited"> </span>
<a id="L149"></a><span class="some-visited"> </span>
<a id="L150"></a><span class="visited"> </span>
<a id="L151"></a><span > </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span > </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span class="visited"> </span>
<a id="L157"></a><span > </span>
<a id="L158"></a><span > </span>
<a id="L159"></a><span class="visited"> </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span class="visited"> </span>
<a id="L163"></a><span class="visited"> </span>
<a id="L164"></a><span > </span>
<a id="L165"></a><span > </span>
<a id="L166"></a><span class="visited"> </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span > </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span > </span>
<a id="L172"></a><span > </span>
<a id="L173"></a><span class="visited"> </span>
<a id="L174"></a><span class="some-visited"> </span>
<a id="L175"></a><span class="visited"> </span>
<a id="L176"></a><span > </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span > </span>
<a id="L179"></a><span class="visited"> </span>
<a id="L180"></a><span > </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span class="some-visited"> </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span class="visited"> </span>
<a id="L185"></a><span class="visited"> </span>
<a id="L186"></a><span class="visited"> </span>
<a id="L187"></a><span class="visited"> </span>
<a id="L188"></a><span class="visited"> </span>
<a id="L189"></a><span class="visited"> </span>
<a id="L190"></a><span class="visited"> </span>
<a id="L191"></a><span class="visited"> </span>
<a id="L192"></a><span class="visited"> </span>
<a id="L193"></a><span > </span>
<a id="L194"></a><span > </span>
<a id="L195"></a><span > </span>
<a id="L196"></a><span class="visited"> </span>
<a id="L197"></a><span > </span>
<a id="L198"></a><span > </span>
<a id="L199"></a><span > </span>
<a id="L200"></a><span class="visited"> </span>
<a id="L201"></a><span class="visited"> </span>
<a id="L202"></a><span class="visited"> </span>
<a id="L203"></a><span class="visited"> </span>
<a id="L204"></a><span class="visited"> </span>
<a id="L205"></a><span > </span>
<a id="L206"></a><span > </span>
<a id="L207"></a><span > </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span > </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span class="visited"> </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span class="some-visited"> </span>
<a id="L218"></a><span class="visited"> </span>
<a id="L219"></a><span class="visited"> </span>
<a id="L220"></a><span > </span>
<a id="L221"></a><span > </span>
<a id="L222"></a><span class="visited"> </span>
<a id="L223"></a><span class="visited"> </span>
<a id="L224"></a><span class="visited"> </span>
<a id="L225"></a><span class="visited"> </span>
<a id="L226"></a><span class="visited"> </span>
<a id="L227"></a><span class="unvisited"> </span>
<a id="L228"></a><span > </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span class="visited"> </span>
<a id="L231"></a><span class="visited"> </span>
<a id="L232"></a><span class="visited"> </span>
<a id="L233"></a><span class="visited"> </span>
<a id="L234"></a><span class="visited"> </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span class="visited"> </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span class="visited"> </span>
<a id="L241"></a><span class="visited"> </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span > </span>
<a id="L244"></a><span class="visited"> </span>
<a id="L245"></a><span > </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span class="visited"> </span>
<a id="L248"></a><span class="visited"> </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span class="visited"> </span>
<a id="L252"></a><span > </span>
<a id="L253"></a><span > </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span class="some-visited"> </span>
<a id="L257"></a><span class="visited"> </span>
<a id="L258"></a><span class="visited"> </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span class="visited"> </span>
<a id="L262"></a><span > </span>
<a id="L263"></a><span > </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span class="visited"> </span>
<a id="L266"></a><span class="visited"> </span>
<a id="L267"></a><span class="visited"> </span>
<a id="L268"></a><span class="visited"> </span>
<a id="L269"></a><span class="visited"> </span>
<a id="L270"></a><span class="unvisited"> </span>
<a id="L271"></a><span > </span>
<a id="L272"></a><span > </span>
<a id="L273"></a><span class="visited"> </span>
<a id="L274"></a><span class="visited"> </span>
<a id="L275"></a><span class="visited"> </span>
<a id="L276"></a><span > </span>
<a id="L277"></a><span > </span>
<a id="L278"></a><span > </span>
<a id="L279"></a><span class="visited"> </span>
<a id="L280"></a><span class="visited"> </span>
<a id="L281"></a><span class="visited"> </span>
<a id="L282"></a><span class="visited"> </span>
<a id="L283"></a><span class="visited"> </span>
<a id="L284"></a><span class="unvisited"> </span>
<a id="L285"></a><span > </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span class="visited"> </span>
<a id="L288"></a><span class="visited"> </span>
<a id="L289"></a><span class="visited"> </span>
<a id="L290"></a><span class="visited"> </span>
<a id="L291"></a><span > </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span > </span>
<a id="L294"></a><span class="unvisited"> </span>
<a id="L295"></a><span class="unvisited"> </span>
<a id="L296"></a><span > </span>
<a id="L297"></a><span > </span>
<a id="L298"></a><span > </span>
<a id="L299"></a><span > </span>
<a id="L300"></a><span > </span>
<a id="L301"></a><span class="visited"> </span>
<a id="L302"></a><span > </span>
<a id="L303"></a><span > </span>
<a id="L304"></a><span class="visited"> </span>
<a id="L305"></a><span > </span>
<a id="L306"></a><span > </span>
<a id="L307"></a><span > </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span > </span>
<a id="L310"></a><span class="visited"> </span>
<a id="L311"></a><span class="visited"> </span>
<a id="L312"></a><span > </span>
<a id="L313"></a><span > </span>
<a id="L314"></a><span class="some-visited"> </span>
<a id="L315"></a><span class="visited"> </span>
<a id="L316"></a><span class="visited"> </span>
<a id="L317"></a><span > </span>
<a id="L318"></a><span > </span>
<a id="L319"></a><span class="some-visited"> </span>
<a id="L320"></a><span class="visited"> </span>
<a id="L321"></a><span class="visited"> </span>
<a id="L322"></a><span > </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span > </span>
<a id="L325"></a><span class="visited"> </span>
<a id="L326"></a><span > </span>
<a id="L327"></a><span > </span>
<a id="L328"></a><span class="visited"> </span>
<a id="L329"></a><span class="visited"> </span>
<a id="L330"></a><span > </span>
<a id="L331"></a><span > </span>
<a id="L332"></a><span > </span>
<a id="L333"></a><span class="visited"> </span>
<a id="L334"></a><span > </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span class="visited"> </span>
<a id="L337"></a><span class="visited"> </span>
<a id="L338"></a><span class="visited"> </span>
<a id="L339"></a><span class="visited"> </span>
<a id="L340"></a><span class="visited"> </span>
<a id="L341"></a><span > </span>
<a id="L342"></a><span > </span>
<a id="L343"></a><span class="visited"> </span>
<a id="L344"></a><span class="visited"> </span>
<a id="L345"></a><span class="some-visited"> </span>
<a id="L346"></a><span class="visited"> </span>
<a id="L347"></a><span class="unvisited"> </span>
<a id="L348"></a><span > </span>
<a id="L349"></a><span > </span>
<a id="L350"></a><span class="visited"> </span>
<a id="L351"></a><span > </span>
<a id="L352"></a><span > </span>
<a id="L353"></a><span class="unvisited"> </span>
<a id="L354"></a><span > </span>
<a id="L355"></a><span class="unvisited"> </span>
<a id="L356"></a><span > </span>
<a id="L357"></a><span > </span>
<a id="L358"></a><span class="unvisited"> </span>
<a id="L359"></a><span class="unvisited"> </span>
<a id="L360"></a><span class="unvisited"> </span>
<a id="L361"></a><span > </span>
<a id="L362"></a><span > </span>
<a id="L363"></a><span > </span>
<a id="L364"></a><span > </span>
<a id="L365"></a><span > </span>
<a id="L366"></a><span > </span>
<a id="L367"></a><span > </span>
<a id="L368"></a><span class="visited"> </span>
<a id="L369"></a><span class="visited"> </span>
<a id="L370"></a><span class="visited"> </span>
<a id="L371"></a><span > </span>
<a id="L372"></a><span > </span>
<a id="L373"></a><span class="unvisited"> </span>
<a id="L374"></a><span class="unvisited"> </span>
<a id="L375"></a><span class="unvisited"> </span>
<a id="L376"></a><span > </span>
<a id="L377"></a><span > </span>
<a id="L378"></a><span class="unvisited"> </span>
<a id="L379"></a><span > </span>
<a id="L380"></a><span > </span>
<a id="L381"></a><span class="unvisited"> </span>
<a id="L382"></a><span class="unvisited"> </span>
<a id="L383"></a><span class="unvisited"> </span>
<a id="L384"></a><span > </span>
<a id="L385"></a><span > </span>
<a id="L386"></a><span > </span>
<a id="L387"></a><span class="unvisited"> </span>
<a id="L388"></a><span class="unvisited"> </span>
<a id="L389"></a><span > </span>
<a id="L390"></a><span > </span>
<a id="L391"></a><span > </span>
<a id="L392"></a><span class="visited"> </span>
<a id="L393"></a><span class="some-visited"> </span>
<a id="L394"></a><span class="visited"> </span>
<a id="L395"></a><span class="some-visited"> </span>
<a id="L396"></a><span class="visited"> </span>
<a id="L397"></a><span class="unvisited"> </span>
<a id="L398"></a><span > </span>
<a id="L399"></a><span > </span>
<a id="L400"></a><span > </span>
<a id="L401"></a><span class="visited"> </span>
<a id="L402"></a><span class="visited"> </span>
<a id="L403"></a><span > </span>
<a id="L404"></a><span > </span>
<a id="L405"></a><span > </span>
<a id="L406"></a><span > </span>
<a id="L407"></a><span class="visited"> </span>
<a id="L408"></a><span class="visited"> </span>
<a id="L409"></a><span class="visited"> </span>
<a id="L410"></a><span class="visited"> </span>
<a id="L411"></a><span class="visited"> </span>
<a id="L412"></a><span class="visited"> </span>
<a id="L413"></a><span > </span>
<a id="L414"></a><span > </span>
<a id="L415"></a><span class="some-visited"> </span>
<a id="L416"></a><span class="some-visited"> </span>
<a id="L417"></a><span class="visited"> </span>
<a id="L418"></a><span class="visited"> </span>
<a id="L419"></a><span > </span>
<a id="L420"></a><span > </span>
<a id="L421"></a><span class="visited"> </span>
<a id="L422"></a><span > </span>
<a id="L423"></a><span > </span>
<a id="L424"></a><span > </span>
<a id="L425"></a><span class="visited"> </span>
<a id="L426"></a><span > </span>
<a id="L427"></a><span > </span>
<a id="L428"></a><span class="unvisited"> </span>
<a id="L429"></a><span > </span>
<a id="L430"></a><span > </span>
<a id="L431"></a><span > </span>
<a id="L432"></a><span class="visited"> </span>
<a id="L433"></a><span > </span>
<a id="L434"></a><span > </span>
<a id="L435"></a><span > </span>
<a id="L436"></a><span > </span>
<a id="L437"></a><span > </span>
<a id="L438"></a><span class="unvisited"> </span>
<a id="L439"></a><span class="unvisited"> </span>
<a id="L440"></a><span > </span>
<a id="L441"></a><span > </span>
<a id="L442"></a><span class="unvisited"> </span>
<a id="L443"></a><span class="unvisited"> </span>
<a id="L444"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
<a href="#L405">405</a>
<a href="#L406">406</a>
<a href="#L407">407</a>
<a href="#L408">408</a>
<a href="#L409">409</a>
<a href="#L410">410</a>
<a href="#L411">411</a>
<a href="#L412">412</a>
<a href="#L413">413</a>
<a href="#L414">414</a>
<a href="#L415">415</a>
<a href="#L416">416</a>
<a href="#L417">417</a>
<a href="#L418">418</a>
<a href="#L419">419</a>
<a href="#L420">420</a>
<a href="#L421">421</a>
<a href="#L422">422</a>
<a href="#L423">423</a>
<a href="#L424">424</a>
<a href="#L425">425</a>
<a href="#L426">426</a>
<a href="#L427">427</a>
<a href="#L428">428</a>
<a href="#L429">429</a>
<a href="#L430">430</a>
<a href="#L431">431</a>
<a href="#L432">432</a>
<a href="#L433">433</a>
<a href="#L434">434</a>
<a href="#L435">435</a>
<a href="#L436">436</a>
<a href="#L437">437</a>
<a href="#L438">438</a>
<a href="#L439">439</a>
<a href="#L440">440</a>
<a href="#L441">441</a>
<a href="#L442">442</a>
<a href="#L443">443</a>
<a href="#L444">444</a>
</pre>
<pre><code class="ocaml">open Core
open Constants

let get_first (pair: 'a * 'b): 'a =
  <span data-count="38">l</span>et (r1, _) = pair in
  r1;;
  
let get_second (pair: 'a * 'b): 'b =
  <span data-count="19">l</span>et (_, r2) = pair in
    r2;;

let get_trio_first (trio: 'a * 'b * 'c): 'a =
  <span data-count="8">l</span>et (r1, _, _) = trio in
    r1;;

let get_trio_second (trio: 'a * 'b * 'c): 'b =
  <span data-count="6">l</span>et (_, r2, _) = trio in
    r2;;

let get_trio_third (trio: 'a * 'b * 'c): 'c =
  <span data-count="12">l</span>et (_, _, r3) = trio in
    r3;;

let not (bool1: bool) : bool =
  <span data-count="5">i</span>f bool1 then <span data-count="1">f</span>alse
  else <span data-count="4">t</span>rue;;

let string_list_of_pieces (color: string) (data: string list list) : string list =
  <span data-count="6">m</span>atch color with 
  | <span data-count="2">"</span>R" -&gt; (List.nth_exn data 0)
  | <span data-count="1">"</span>Y" -&gt; (List.nth_exn data 1)
  | <span data-count="1">"</span>B" -&gt; (List.nth_exn data 2)
  | <span data-count="1">"</span>G" -&gt; (List.nth_exn data 3)
  | <span data-count="1">_</span> -&gt; ["\n     ERROR!\n"];;

(* All for converting a board to a string *)
let remove_first_char (inputString: string): string =
  <span data-count="109217">S</span>tring.sub inputString ~pos:(1) ~len:(String.lengt<span data-count="109217">h</span> inputString - 1);;

let add_to_string (input: string) (input2: string): string = <span data-count="802">i</span>nput ^ "  " ^ input2;;

let remove_double_digits (index: int) (a: string): string =
  <span data-count="42">i</span>f (index &gt; 9) then <span data-count="23">r</span>emove_first_char a 
  else <span data-count="19">a</span>;;

let row_to_string (row: string list) : string =
  <span data-count="41">"</span>    " ^ (List.fol<span data-count="41">d</span> ~f:(add_to_string) ~init:("") row) ^ "\n";;

let board_to_string_stdio (board: string list list) =
  <span data-count="2">"</span>\n       A  B  C  D  E  F  G  H  I  J  K  L  M  N  O  P  Q  R  S  T\n\n" ^ List.fol<span data-count="2">d</span> ~f:(^) ~init:("") (List.map<span data-count="2">i</span> ~f:(fun index -&gt; fun a -&gt; <span data-count="40">(</span>(Int.to_strin<span data-count="40">g</span> (index + 1)) ^ a)) (List.map<span data-count="2">i</span> ~f:(fun index -&gt; fun a -&gt; <span data-count="40">r</span>emove_double_digits (index + 1) a) (List.ma<span data-count="2">p</span> ~f:(row_to_string) board)));;

let to_string_file (board_or_piece: string list list) = 
  <span data-count="0">L</span>ist.fold ~f:(^) ~init:("") (List.ma<span data-count="0">p</span> ~f:(row_to_string) board_or_piece);;



(* Converts command line arguemnt number of Ai's to the string for state.txt *)
let ai_string (num_ai: string) : string =
  <span data-count="5">m</span>atch num_ai with 
  | <span data-count="1">"</span>0" -&gt; "      \n"
  | <span data-count="1">"</span>1" -&gt; "      Y\n"
  | <span data-count="1">"</span>2" -&gt; "      B Y\n"
  | <span data-count="1">"</span>3" -&gt; "      G B Y\n"
  | <span data-count="1">_</span> -&gt; "      ERROR\n";;



(* Make a string from the file contents *)
let make_string_from_file (file : string) : string = <span data-count="6">f</span>ile |&gt; In_channel.read_all;;

let make_list_of_lines (curr: string) : string list = <span data-count="7">c</span>urr |&gt; String.split_on_chars ~on: (['\t'; '\r'; '\n'; '\x0C']);;

let empty_string_bool (curr: string) : bool =
  <span data-count="3195">(</span>String.lengt<span data-count="3195">h</span> curr) &lt;&gt; 0;;

let make_list_of_chars (curr: string) : string list = <span data-count="79">c</span>urr |&gt; String.split_on_char<span data-count="79">s</span> ~on: (['\t'; '\r'; '\n'; ' '; '\x0C']) |&gt; List.filter ~f:(empty_string_bool);;



let rec subset_helper (data: 'a list) (final: int) (index: int) : 'a list =
  <span data-count="332508">i</span>f (index = List.lengt<span data-count="332508">h</span> data) then <span data-count="5061">[</span>]
  else <span data-count="327447">i</span>f ((index) = final + 1) then <span data-count="88257">[</span>]
  else <span data-count="239190">L</span>ist.nth_ex<span data-count="239190">n</span> data index :: subset_helpe<span data-count="239190">r</span> data final (index + 1);;

(* inclusive
  pre: start and final are valid indices of data  
*)
let subset (data: 'a list) (start: int) (final: int) : 'a list =
  <span data-count="93318">s</span>ubset_helper data final start;;


 
(* Processes information from the command line
  First command line argument is the executable
  Second command line arugment is the number of the piece you want to place
  Third command line argument is the coordinate of the piece you want to play (coordinate of the left most part in the top row of the piece)
  First two parts of return value are the parts from load_gamee\
  Third part is a string list in this format ["Piece#";"PieceRepresentation";"A1"]  
*)
let process_command_line (data: string list list * string list list) (command_args: string list): (string list list * string list list * string list) =
  <span data-count="1">l</span>et piece_num = (List.nth_exn command_args 1) in
    <span data-count="1">l</span>et rep_num = (List.nth_exn command_args 2) in
      <span data-count="1">l</span>et coord = (List.nth_exn command_args 3) in
        <span data-count="1">(</span>get_firs<span data-count="1">t</span> data, get_secon<span data-count="1">d</span> data, [piece_num; rep_num;coord]);;


let rec remove_piece_helper (data: string list) (to_remove: string) (curr: int) : string list =
  <span data-count="54">i</span>f (List.lengt<span data-count="54">h</span> data = curr) then <span data-count="16">[</span>]
  else <span data-count="38">i</span>f (String.equal (List.nth_ex<span data-count="38">n</span> data curr) to_remove) then <span data-count="16">r</span>emove_piece_helper data to_remove (curr + 1)
  else <span data-count="22">(</span>List.nth_ex<span data-count="22">n</span> data curr) ::  remove_piece_helpe<span data-count="22">r</span> data to_remove (curr + 1);;

(* Removes a piece number from the string list, puts two zeros if removing the last piece *)
let remove_piece (data: string list) (to_remove: string): string list =
  <span data-count="8">i</span>f (List.lengt<span data-count="8">h</span> (remove_piece_helpe<span data-count="8">r</span> data to_remove 0)) = 0 then <span data-count="0">[</span>"0"; "0"]
  else <span data-count="8">(</span>remove_piece_helper data to_remove 0);;   

(* Returns the color of the player whose turn it is next *)
let next_color (color: string) : string =
  <span data-count="20">m</span>atch color with 
  | <span data-count="6">"</span>R" -&gt; "Y"
  | <span data-count="3">"</span>Y" -&gt; "B"
  | <span data-count="3">"</span>B" -&gt; "G"
  | <span data-count="7">"</span>G" -&gt; "R"
  | <span data-count="1">_</span> -&gt; "ERROR!";;

let update_pieces (color: string) (data: string list list) (to_remove: string) : string list list =
  <span data-count="6">m</span>atch color with
  | <span data-count="2">"</span>R" -&gt; (remove_piec<span data-count="2">e</span> (List.nth_ex<span data-count="2">n</span> data 0) to_remove)  :: (List.nth_ex<span data-count="2">n</span> data 1) :: (List.nth_ex<span data-count="2">n</span> data 2) :: (List.nth_ex<span data-count="2">n</span> data 3) :: (List.nth_ex<span data-count="2">n</span> data 4) :: [[(next_colo<span data-count="2">r</span> color)]]
  | <span data-count="1">"</span>Y" -&gt; (List.nth_ex<span data-count="1">n</span> data 0) :: (remove_piec<span data-count="1">e</span> (List.nth_ex<span data-count="1">n</span> data 1) to_remove) :: (List.nth_ex<span data-count="1">n</span> data 2) :: (List.nth_ex<span data-count="1">n</span> data 3) :: (List.nth_ex<span data-count="1">n</span> data 4) :: [[(next_colo<span data-count="1">r</span> color)]]
  | <span data-count="1">"</span>B" -&gt; (List.nth_ex<span data-count="1">n</span> data 0) :: (List.nth_ex<span data-count="1">n</span> data 1) :: (remove_piec<span data-count="1">e</span> (List.nth_ex<span data-count="1">n</span> data 2) to_remove) :: (List.nth_ex<span data-count="1">n</span> data 3) :: (List.nth_ex<span data-count="1">n</span> data 4) :: [[(next_colo<span data-count="1">r</span> color)]]
  | <span data-count="1">"</span>G" -&gt; (List.nth_ex<span data-count="1">n</span> data 0) :: (List.nth_ex<span data-count="1">n</span> data 1) :: (List.nth_ex<span data-count="1">n</span> data 2) :: (remove_piec<span data-count="1">e</span> (List.nth_ex<span data-count="1">n</span> data 3) to_remove) :: (List.nth_ex<span data-count="1">n</span> data 4) :: [[(next_colo<span data-count="1">r</span> color)]]
  | <span data-count="1">_</span> -&gt;  [["\n     ERROR!\n"]];;




let coord_col (coord: string) : int =
  <span data-count="196207">(</span>Char.to_in<span data-count="196207">t</span> coord.[0]) - 65;;

let coord_row (coord: string) : int =
  <span data-count="109193">(</span>int_of_strin<span data-count="109193">g</span> (remove_first_cha<span data-count="109193">r</span> coord)) - 1;;



(* Next 5 functions are all for putting the piece on the board. They are only used after it is determined that the move is allowed *)

let rec combine_board_piece_helper (piece_row: string list) (board_row: string list) (index: int) (color: string) : string list =
  <span data-count="36">i</span>f (index = List.lengt<span data-count="36">h</span> piece_row) then <span data-count="9">[</span>]
  else <span data-count="27">i</span>f (String.equal (List.nth_ex<span data-count="27">n</span> piece_row index) "X") then <span data-count="0">(</span>List.nth_ex<span data-count="0">n</span> board_row index) :: (combine_board_piece_helpe<span data-count="0">r</span> piece_row board_row (index + 1) color)
  else <span data-count="27">c</span>olor :: (combine_board_piece_helpe<span data-count="27">r</span> piece_row board_row (index + 1) color);;

(* Combines the piece row and board row
    For example, if piece_row = ["X";"P";"X";"P"],board_row = ["R";"X";"X";"G"],and color = "G" then ["R";"G";"X";"G"] is returned 
*)
let combine_board_piece (piece_row: string list) (board_row: string list) (color: string) : string list =
  <span data-count="9">c</span>ombine_board_piece_helper piece_row board_row 0 color;;

let insert_piece_col (piece_row: string list) (board_row: string list) (coord: string) (color: string) : string list =
  <span data-count="9">(</span>subse<span data-count="9">t</span> board_row 0 (coord_co<span data-count="9">l</span> coord - 1)) @ (combine_board_piec<span data-count="9">e</span> piece_row (subse<span data-count="9">t</span> board_row ((coord_co<span data-count="9">l</span> coord)) (coord_co<span data-count="9">l</span> coord + (List.lengt<span data-count="9">h</span> piece_row) - 1)) color) @ subse<span data-count="9">t</span> board_row (coord_co<span data-count="9">l</span> coord + (List.lengt<span data-count="9">h</span> piece_row)) 19;;

let rec insert_piece (piece: string list list) (board: string list list) (coord: string) (counter: int) (curr: int) (color: string): string list list =
  <span data-count="12">i</span>f (List.lengt<span data-count="12">h</span> piece = counter) then <span data-count="3">(</span>subset board (coord_ro<span data-count="3">w</span> coord + counter) 19)
  else <span data-count="9">(</span>subse<span data-count="9">t</span> board curr (coord_ro<span data-count="9">w</span> coord + counter - 1)) @ [(insert_piece_co<span data-count="9">l</span> (List.nth_ex<span data-count="9">n</span> piece counter) (List.nth_ex<span data-count="9">n</span> board (coord_ro<span data-count="9">w</span> coord + counter)) coord color)]  @ insert_piec<span data-count="9">e</span> piece board coord (counter + 1) (coord_ro<span data-count="9">w</span> coord + counter + 1) color;;

let put_piece_on_board (piece: string list list) (board: string list list) (coord: string) (color: string): string list list =
  <span data-count="3">i</span>nsert_piece piece board coord 0 0 color;;



(* Next 5 functions are for determining if a move is allowed *)
  
let rec trim_section (sub_board: string list list) (piece: string list list) (coord: string) (index: int) : string list list =
  <span data-count="93271">i</span>f (index = List.lengt<span data-count="93271">h</span> piece) then <span data-count="25516">[</span>]
  else <span data-count="67755">i</span>f (index = List.lengt<span data-count="67755">h</span> sub_board) then <span data-count="0">[</span>]
  else <span data-count="67755">s</span>ubse<span data-count="67755">t</span> (List.nth_ex<span data-count="67755">n</span> sub_board (index)) (coord_co<span data-count="67755">l</span> coord) ((-1) + (coord_co<span data-count="67755">l</span> coord) + List.lengt<span data-count="67755">h</span> (List.nth_ex<span data-count="67755">n</span> piece 0)) :: trim_sectio<span data-count="67755">n</span> sub_board piece coord (index + 1);;

(* This gets the rectangular section of the board that the piece will be put onto *)
let board_section_to_place (piece: string list list) (board: string list list) (coord: string) : string list list =
  <span data-count="25516">t</span>rim_section (subse<span data-count="25516">t</span> board (coord_ro<span data-count="25516">w</span> coord) ((-1) + (coord_ro<span data-count="25516">w</span> coord) + List.lengt<span data-count="25516">h</span> piece)) piece coord 0;;

let rec test_valid_placement_helper (sub_board: string list list) (piece: string list list) (index: int) (color: string) (same: bool): bool =
  <span data-count="194647">i</span>f (List.lengt<span data-count="194647">h</span> sub_board) = 0 then <span data-count="0">t</span>rue
  else
  <span data-count="194647">l</span>et col = index % (List.lengt<span data-count="194647">h</span> (List.nth_ex<span data-count="194647">n</span> sub_board 0)) in
    <span data-count="194647">l</span>et row = index / (List.lengt<span data-count="194647">h</span> (List.nth_ex<span data-count="194647">n</span> sub_board 0)) in
      if index = ((List.lengt<span data-count="194647">h</span> (List.nth_ex<span data-count="194647">n</span> sub_board 0)) * (List.lengt<span data-count="194647">h</span> sub_board)) then <span data-count="25100">t</span>rue &amp;&amp; <span data-count="25100">s</span>ame
      else <span data-count="169547">i</span>f String.equal (List.nth_ex<span data-count="169547">n</span> (List.nth_ex<span data-count="169547">n</span> sub_board row) col) "-" then <span data-count="168867">t</span>est_valid_placement_helper sub_board piece (index + 1) color same
      else <span data-count="680">i</span>f String.equal (List.nth_ex<span data-count="680">n</span> (List.nth_ex<span data-count="680">n</span> piece row) col) "X" then <span data-count="203">t</span>est_valid_placement_helper sub_board piece (index + 1) color same
      else <span data-count="477">i</span>f String.equal (List.nth_ex<span data-count="477">n</span> (List.nth_ex<span data-count="477">n</span> sub_board row) col) color then 
        <span data-count="62">i</span>f same then <span data-count="1">f</span>alse
        else <span data-count="61">t</span>est_valid_placement_helper sub_board piece (index + 1) color true
      else <span data-count="415">f</span>alse;;

(* This determines if the piece is overlaps one tile of the color and no other tiles *)
let test_valid_placement (sub_board: string list list) (piece: string list list) (color: string) : bool =
  <span data-count="25516">t</span>est_valid_placement_helper sub_board piece 0 color false;;

(* This functions determines if the move is allowed in terms of in bounds and only overlapping one tile of the same color *)
let try_put_piece_on_board (piece: string list list) (board: string list list) (coord: string) (color: string): bool =
   <span data-count="30331">i</span>f (coord_co<span data-count="30331">l</span> coord &lt; 0) then <span data-count="1">f</span>alse
   else <span data-count="30330">i</span>f (coord_ro<span data-count="30330">w</span> coord &lt; 0) then <span data-count="1">f</span>alse
   else <span data-count="30329">i</span>f ((coord_co<span data-count="30329">l</span> coord) + (List.lengt<span data-count="30329">h</span> (List.nth_ex<span data-count="30329">n</span> piece 0)) - 1 &gt; 19) then <span data-count="2529">f</span>alse
   else <span data-count="27800">i</span>f ((coord_ro<span data-count="27800">w</span> coord) + (List.lengt<span data-count="27800">h</span> piece) - 1 &gt; 19) then <span data-count="2284">f</span>alse
   else <span data-count="25516">t</span>est_valid_placement (board_section_to_plac<span data-count="25516">e</span> piece board coord) piece color;;






(* Next 9 functions are used to see if there are any possible moves for a particular player *)

let col_row_to_coord (col: int) (row: int) : string =
  <span data-count="30322">(</span>String.mak<span data-count="30322">e</span> 1 (char_of_in<span data-count="30322">t</span> (col + 65))) ^ (string_of_in<span data-count="30322">t</span> (row + 1));;

let rec get_pieces_test_helper (curr: int) (hand: string list) : string list list list list =
  <span data-count="93">i</span>f (curr = List.lengt<span data-count="93">h</span> piecesStrings) then <span data-count="0">[</span>]
  else <span data-count="93">i</span>f (curr = List.lengt<span data-count="93">h</span> hand) then <span data-count="6">[</span>]
  else <span data-count="87">L</span>ist.nth_ex<span data-count="87">n</span> pieces (int_of_strin<span data-count="87">g</span> (List.nth_ex<span data-count="87">n</span> hand curr)) :: get_pieces_test_helpe<span data-count="87">r</span> (curr + 1) hand;;

let get_pieces_test  (color: string) (data: string list list) : string list list list list =
  <span data-count="6">m</span>atch color with 
  | <span data-count="3">"</span>R" -&gt; get_pieces_test_helper 0 (List.nth_ex<span data-count="3">n</span> data 0)
  | <span data-count="1">"</span>Y" -&gt; get_pieces_test_helper 0 (List.nth_ex<span data-count="1">n</span> data 1)
  | <span data-count="1">"</span>B" -&gt; get_pieces_test_helper 0 (List.nth_ex<span data-count="1">n</span> data 2)
  | <span data-count="1">"</span>G" -&gt; get_pieces_test_helper 0 (List.nth_ex<span data-count="1">n</span> data 3)
  | <span data-count="0">_</span> -&gt; [[[["\n     ERROR!\n"]]]];;

let rec test_piece_rep_possible_move_helper (board: string list list) (piece: string list list) (index: int) (color: string): bool =
  <span data-count="30394">l</span>et col = index % (List.lengt<span data-count="30394">h</span> (List.nth_ex<span data-count="30394">n</span> board 0)) in
    <span data-count="30394">l</span>et row = index / (List.lengt<span data-count="30394">h</span> (List.nth_ex<span data-count="30394">n</span> board 0)) in
      if index = ((List.lengt<span data-count="30394">h</span> (List.nth_ex<span data-count="30394">n</span> board 0)) * (List.lengt<span data-count="30394">h</span> board)) then <span data-count="74">f</span>alse
      else <span data-count="30320">i</span>f try_put_piece_on_board piece board (col_row_to_coor<span data-count="30320">d</span> col row) color then <span data-count="6">t</span>rue
      else <span data-count="30314">t</span>est_piece_rep_possible_move_helper board piece (index + 1) color;;

let test_piece_rep_possible_move (board: string list list) (piece: string list list) (color: string) : bool =
  <span data-count="80">t</span>est_piece_rep_possible_move_helper board piece 0 color;;

let rec test_piece_possible_move_helper (board: string list list) (piece: string list list list) (color: string) (counter: int) : bool =
  <span data-count="96">i</span>f counter = (List.lengt<span data-count="96">h</span> piece) then <span data-count="17">f</span>alse
  else <span data-count="79">t</span>est_piece_rep_possible_mov<span data-count="79">e</span> board (List.nth_ex<span data-count="79">n</span> piece counter) colo<span data-count="5">r</span> || test_piece_possible_move_helper board piece color (counter + 1);;

let test_piece_possible_move (board: string list list) (piece: string list list list) (color: string) : bool =
  <span data-count="22">t</span>est_piece_possible_move_helper board piece color 0;;

let rec test_all_possible_moves_helper (board: string list list) (pieces: string list list list list) (color: string) (counter: int) : bool =
  <span data-count="23">i</span>f counter = (List.lengt<span data-count="23">h</span> pieces) then <span data-count="1">f</span>alse
  else <span data-count="22">t</span>est_piece_possible_mov<span data-count="22">e</span> board (List.nth_ex<span data-count="22">n</span> pieces counter) colo<span data-count="5">r</span> || test_all_possible_moves_helper board pieces color (counter + 1);;

let test_all_possible_moves (board: string list list) (color: string) (data: string list list) : bool =
  <span data-count="6">t</span>est_all_possible_moves_helper board (get_pieces_tes<span data-count="6">t</span> color data) color 0;;



let rec player_score_helper (hand: string list) (curr: int) : int =
  <span data-count="33">i</span>f (curr = List.lengt<span data-count="33">h</span> piecesStrings) then <span data-count="0">0</span>
  else <span data-count="33">i</span>f (curr = List.lengt<span data-count="33">h</span> hand) then <span data-count="11">0</span>
  else <span data-count="22">(</span>List.nth_ex<span data-count="22">n</span> piecesScore (int_of_strin<span data-count="22">g</span> (List.nth_ex<span data-count="22">n</span> hand curr))) + (player_score_helpe<span data-count="22">r</span> hand (curr + 1));;

let player_score (hand: string list) : string =
  <span data-count="11">s</span>tring_of_int (player_score_helpe<span data-count="11">r</span> hand 0);;

(* Looks for a 0 in data that signifies that a player has no more moves *)
let check_for_0  (color: string) (data: string list list) : bool =
<span data-count="17">m</span>atch color with 
| <span data-count="7">"</span>R" -&gt; String.equal "0" (List.nth_ex<span data-count="7">n</span>(List.nth_ex<span data-count="7">n</span> data 0) 0)
| <span data-count="4">"</span>Y" -&gt; String.equal "0" (List.nth_ex<span data-count="4">n</span>(List.nth_ex<span data-count="4">n</span> data 1) 0)
| <span data-count="3">"</span>B" -&gt; String.equal "0" (List.nth_ex<span data-count="3">n</span>(List.nth_ex<span data-count="3">n</span> data 2) 0)
| <span data-count="3">"</span>G" -&gt; String.equal "0" (List.nth_ex<span data-count="3">n</span>(List.nth_ex<span data-count="3">n</span> data 3) 0)
| <span data-count="0">_</span> -&gt; true;;

let check_next_player_done (loaded: (string list list * string list list)): bool =
  <span data-count="8">l</span>et data = get_first loaded in
    <span data-count="8">l</span>et color = (List.nth_exn (List.nth_ex<span data-count="8">n</span> data 5) 0) in
      <span data-count="8">c</span>heck_for_0 color data;;

(* Fills in the data for when a playeer is skipped *)
let skip_player (color: string) (data: string list list) : string list list =
  <span data-count="10">m</span>atch color with 
  | <span data-count="3">"</span>R" -&gt; ["0"; player_scor<span data-count="3">e</span> (List.nth_ex<span data-count="3">n</span> data 0)]  :: (List.nth_ex<span data-count="3">n</span> data 1) :: (List.nth_ex<span data-count="3">n</span> data 2) :: (List.nth_ex<span data-count="3">n</span> data 3) :: (List.nth_ex<span data-count="3">n</span> data 4) :: [[(next_colo<span data-count="3">r</span> color)]]
  | <span data-count="1">"</span>Y" -&gt; (List.nth_ex<span data-count="1">n</span> data 0) :: ["0"; player_scor<span data-count="1">e</span> (List.nth_ex<span data-count="1">n</span> data 1)] :: (List.nth_ex<span data-count="1">n</span> data 2) :: (List.nth_ex<span data-count="1">n</span> data 3) :: (List.nth_ex<span data-count="1">n</span> data 4) :: [[(next_colo<span data-count="1">r</span> color)]]
  | <span data-count="1">"</span>B" -&gt; (List.nth_ex<span data-count="1">n</span> data 0) :: (List.nth_ex<span data-count="1">n</span> data 1) :: ["0"; player_scor<span data-count="1">e</span> (List.nth_ex<span data-count="1">n</span> data 2)] :: (List.nth_ex<span data-count="1">n</span> data 3) :: (List.nth_ex<span data-count="1">n</span> data 4) :: [[(next_colo<span data-count="1">r</span> color)]]
  | <span data-count="5">"</span>G" -&gt; (List.nth_ex<span data-count="5">n</span> data 0) :: (List.nth_ex<span data-count="5">n</span> data 1) :: (List.nth_ex<span data-count="5">n</span> data 2) :: ["0"; player_scor<span data-count="5">e</span> (List.nth_ex<span data-count="5">n</span> data 3)] :: (List.nth_ex<span data-count="5">n</span> data 4) :: [[(next_colo<span data-count="5">r</span> color)]]
  | <span data-count="0">_</span> -&gt; [["\n     ERROR!\n"]];;

let skip_turn (pair: (string list list * string list list)): (string list list * string list list) = 
  <span data-count="10">l</span>et data = get_first pair in
    <span data-count="10">l</span>et color = List.nth_exn (List.nth_ex<span data-count="10">n</span> (data) 5) 0 in
      <span data-count="10">l</span>et board = get_second pair in
        <span data-count="10">(</span>(skip_playe<span data-count="10">r</span> color data), board);;

(* Checks if the person after the one skipped should be skipped, and does so if needed *)        
let rec skip_turn_try_multiple (loaded: (string list list * string list list)) : (string list list * string list list) =
  <span data-count="0">i</span>f check_next_player_done (skip_tur<span data-count="0">n</span> loaded) then <span data-count="0">s</span>kip_turn_try_multiple (skip_tur<span data-count="0">n</span> loaded)
  else <span data-count="0">s</span>kip_turn loaded;;




let game_over (loaded: (string list list * string list list)): (string list list * string list list) =
  <span data-count="3">(</span>(get_firs<span data-count="3">t</span> loaded) @ [["GAME OVER!"]], get_secon<span data-count="3">d</span> loaded);;

let check_game_over (loaded: (string list list * string list list)): bool =
  <span data-count="3">c</span>heck_for_<span data-count="3">0</span> "R" (get_firs<span data-count="3">t</span> loaded) &amp;&amp; <span data-count="2">c</span>heck_for_<span data-count="2">0</span> "Y" (get_firs<span data-count="2">t</span> loaded) &amp;&amp; <span data-count="2">c</span>heck_for_<span data-count="2">0</span> "B" (get_firs<span data-count="2">t</span> loaded) &amp;&amp; <span data-count="2">c</span>heck_for_0 "G" (get_firs<span data-count="2">t</span> loaded);;

  
(* Next 15/16 functions are for the ai moves *)

let check_ai (data: string list list) : bool =
  <span data-count="3">l</span>et next_player = List.nth_exn (List.nth_ex<span data-count="3">n</span> data 5) 0 in
    <span data-count="3">L</span>ist.fold ~f:(||) ~init:(false) (List.ma<span data-count="3">p</span> ~f:(String.equa<span data-count="3">l</span> next_player) (List.nth_ex<span data-count="3">n</span> data 4));;

let rec iota1 (n: int): string list =
  <span data-count="3">i</span>f n = 0 then <span data-count="0">[</span>]
  else <span data-count="3">i</span>f n = 1 then <span data-count="2">[</span>"1"]
  else <span data-count="1">(</span>string_of_in<span data-count="1">t</span> n) :: iota<span data-count="1">1</span> (n - 1);;

let rec list_of_same (item: int) (n: int): string list =
  <span data-count="3">i</span>f n = 0 then <span data-count="0">[</span>]
  else <span data-count="3">i</span>f n = 1 then <span data-count="2">[</span>string_of_in<span data-count="2">t</span> item]
  else <span data-count="1">s</span>tring_of_in<span data-count="1">t</span> item :: list_of_sam<span data-count="1">e</span> item (n - 1);;

(* Makes a list of (pieceNumber, repNumber) for a piece *)
let get_piece_reps (pieceNumber: string) : (string * string) list =
  <span data-count="2">L</span>ist.zip_exn (list_of_sam<span data-count="2">e</span> (int_of_strin<span data-count="2">g</span> pieceNumber) ((List.lengt<span data-count="2">h</span> (List.nth_ex<span data-count="2">n</span> pieces (int_of_strin<span data-count="2">g</span> pieceNumber))))) (List.re<span data-count="2">v</span> (iota<span data-count="2">1</span> (List.lengt<span data-count="2">h</span> (List.nth_ex<span data-count="2">n</span> pieces (int_of_strin<span data-count="2">g</span> pieceNumber)))));;

let rec get_piece_reps_helper (pieces: string list) (index: int) : (string * string) list =
  <span data-count="3">i</span>f (index = List.lengt<span data-count="3">h</span> pieces) then <span data-count="1">[</span>]
  else <span data-count="2">g</span>et_piece_rep<span data-count="2">s</span> (List.nth_ex<span data-count="2">n</span> pieces index) @ get_piece_reps_helpe<span data-count="2">r</span> pieces (index + 1);;

(* Makes a list of (pieceNumber, repNumber) for all of a player's pieces *)
let get_pieces_reps (pieces: string list) : (string * string) list =
  <span data-count="1">g</span>et_piece_reps_helper pieces 0;;

let check_possible_rep_valid (piece_and_rep: (string * string)) (loaded: (string list list * string list list)) : bool =
  <span data-count="1">l</span>et piece_num = int_of_string (get_firs<span data-count="1">t</span> piece_and_rep) in
    <span data-count="1">l</span>et rep_num = int_of_string (get_secon<span data-count="1">d</span> piece_and_rep) in
      <span data-count="1">l</span>et board = get_second loaded in
        <span data-count="1">l</span>et data = get_first loaded in
          <span data-count="1">t</span>est_piece_rep_possible_move board (List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> pieces piece_num) (rep_num - 1)) (List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> data 5) 0);;

let rec piece_rep_do_possible_move_coords_helper (board: string list list) (piece: string list list) (index: int) (color: string): string =
  <span data-count="1">l</span>et col = index % (List.lengt<span data-count="1">h</span> (List.nth_ex<span data-count="1">n</span> board 0)) in
    <span data-count="1">l</span>et row = index / (List.lengt<span data-count="1">h</span> (List.nth_ex<span data-count="1">n</span> board 0)) in
      if index = ((List.lengt<span data-count="1">h</span> (List.nth_ex<span data-count="1">n</span> board 0)) * (List.lengt<span data-count="1">h</span> board)) then <span data-count="0">"</span>ERROR"
      else <span data-count="1">i</span>f try_put_piece_on_board piece board (col_row_to_coor<span data-count="1">d</span> col row) color then <span data-count="1">c</span>ol_row_to_coord col row
      else <span data-count="0">p</span>iece_rep_do_possible_move_coords_helper board piece (index + 1) color;;

let piece_rep_do_possible_move_coords (board: string list list) (piece: string list list) (color: string) : string =
  <span data-count="1">p</span>iece_rep_do_possible_move_coords_helper board piece 0 color;;

let random_to_front (info: 'a list) : 'a list =
  <span data-count="0">l</span>et random_num = 1 + Random.in<span data-count="0">t</span> (-1 + List.lengt<span data-count="0">h</span> info) in
    match List.split_n info random_num with
    | <span data-count="0">(</span>first, second) -&gt; List.hd_ex<span data-count="0">n</span> (second) ::first @ (List.tl_ex<span data-count="0">n</span> second);;

let rec shuffle (info: 'a list) (times: int) : 'a list =
  <span data-count="0">i</span>f List.lengt<span data-count="0">h</span> info &lt; 2 then <span data-count="0">i</span>nfo
  else <span data-count="0">i</span>f (times &gt; 0) then <span data-count="0">s</span>huffle (random_to_fron<span data-count="0">t</span> info) (times - 1)
  else <span data-count="0">i</span>nfo;;

(* Play the piece selected in the third element of the tuple
   Playing the piece entails playing the updating the 
      First element of the tuple: update piecees a player has and whose turn it is
      Second element: update the board with the new piece places
*)  
let play_piece (tuple: (string list list * string list list * string list)): (string list list * string list list) = 
  <span data-count="2">i</span>f (try_put_piece_on_board (List.nth_ex<span data-count="2">n</span> (List.nth_ex<span data-count="2">n</span> pieces (int_of_strin<span data-count="2">g</span> (List.nth_ex<span data-count="2">n</span> (get_trio_thir<span data-count="2">d</span> tuple) 0))) ((-1) + int_of_strin<span data-count="2">g</span> (List.nth_ex<span data-count="2">n</span> (get_trio_thir<span data-count="2">d</span> tuple) 1))) (get_trio_secon<span data-count="2">d</span> tuple) (List.nth_ex<span data-count="2">n</span> (get_trio_thir<span data-count="2">d</span> tuple) 2)   (List.nth_ex<span data-count="2">n</span> (List.nth_ex<span data-count="2">n</span> (get_trio_firs<span data-count="2">t</span> tuple) 5) 0) ) then
    <span data-count="1">(</span>update_piece<span data-count="1">s</span> (List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> (get_trio_firs<span data-count="1">t</span> tuple) 5) 0) (get_trio_firs<span data-count="1">t</span> tuple) (List.nth_ex<span data-count="1">n</span> (get_trio_thir<span data-count="1">d</span> tuple) 0), (put_piece_on_boar<span data-count="1">d</span> (List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> pieces (int_of_strin<span data-count="1">g</span> (List.nth_ex<span data-count="1">n</span> (get_trio_thir<span data-count="1">d</span> tuple) 0))) ((-1) + int_of_strin<span data-count="1">g</span> (List.nth_ex<span data-count="1">n</span> (get_trio_thir<span data-count="1">d</span> tuple) 1))) (get_trio_secon<span data-count="1">d</span> tuple) (List.nth_ex<span data-count="1">n</span> (get_trio_thir<span data-count="1">d</span> tuple) 2)   (List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> (get_trio_firs<span data-count="1">t</span> tuple) 5) 0) ))
  else <span data-count="1">(</span>get_trio_firs<span data-count="1">t</span> tuple, get_trio_secon<span data-count="1">d</span> tuple);;

let rec do_random_move_helper (possible_reps: (string * string) list) (loaded: (string list list * string list list)) (index: int) :  (string list list * string list list) =
  <span data-count="0">i</span>f index = List.lengt<span data-count="0">h</span> possible_reps then <span data-count="0">l</span>oaded
  else <span data-count="0">i</span>f check_possible_rep_valid (List.nth_ex<span data-count="0">n</span> possible_reps index) loaded then <span data-count="0">p</span>lay_piece (get_firs<span data-count="0">t</span> loaded, get_secon<span data-count="0">d</span> loaded, [get_firs<span data-count="0">t</span> (List.nth_ex<span data-count="0">n</span> possible_reps index); get_secon<span data-count="0">d</span> (List.nth_ex<span data-count="0">n</span> possible_reps index); piece_rep_do_possible_move_coord<span data-count="0">s</span> (get_secon<span data-count="0">d</span> loaded) (List.nth_ex<span data-count="0">n</span> (List.nth_ex<span data-count="0">n</span> pieces ((int_of_strin<span data-count="0">g</span> (get_firs<span data-count="0">t</span> (List.nth_ex<span data-count="0">n</span> possible_reps index))))) ((int_of_strin<span data-count="0">g</span> (get_secon<span data-count="0">d</span> (List.nth_ex<span data-count="0">n</span> possible_reps index))) - 1)) (List.nth_ex<span data-count="0">n</span> (List.nth_ex<span data-count="0">n</span> (get_firs<span data-count="0">t</span> loaded) 5) 0)])
  else <span data-count="0">d</span>o_random_move_helper possible_reps loaded (index + 1);;

let do_random_move (possible_reps: (string * string) list) (loaded: (string list list * string list list)) :  (string list list * string list list) =
  <span data-count="0">d</span>o_random_move_helper (shuffl<span data-count="0">e</span> possible_reps 100) loaded 0;;

let ai_move (loaded: (string list list * string list list)) : (string list list * string list list) =
  <span data-count="0">l</span>et data = get_first loaded in
    <span data-count="0">l</span>et possible_reps = get_pieces_reps (string_list_of_piece<span data-count="0">s</span> (List.nth_ex<span data-count="0">n</span> (List.nth_ex<span data-count="0">n</span> data 5) 0) (data)) in
      <span data-count="0">d</span>o_random_move possible_reps loaded;;

(* If there are multiple ai, this funcitons calls itself *)
let rec ai_move_try_multiple (loaded: (string list list * string list list)) : (string list list * string list list) =
  <span data-count="0">i</span>f check_ai (get_firs<span data-count="0">t</span> (ai_mov<span data-count="0">e</span> loaded)) then <span data-count="0">a</span>i_move_try_multiple (ai_mov<span data-count="0">e</span> loaded)
  else <span data-count="0">a</span>i_move loaded;;


let check_next_player (loaded: (string list list * string list list)) : (string list list * string list list) =
  <span data-count="2">i</span>f check_game_over loaded then <span data-count="1">(</span>game_over loaded)
  else <span data-count="1">i</span>f (check_next_player_done loaded) then <span data-count="0">(</span>skip_turn_try_multiple loaded)
  else <span data-count="1">i</span>f (test_all_possible_moves (get_secon<span data-count="1">d</span> loaded) (List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> (get_firs<span data-count="1">t</span> loaded) 5) 0) (get_firs<span data-count="1">t</span> loaded)) then 
    <span data-count="1">i</span>f (check_ai (get_firs<span data-count="1">t</span> loaded)) then <span data-count="0">a</span>i_move_try_multiple loaded
    else <span data-count="1">l</span>oaded
  else <span data-count="0">(</span>skip_turn loaded);;

(* If there are multiple people to be skipped, this funcitons calls itself *)  
let rec skip_turn_try_multiple (loaded: (string list list * string list list)) : (string list list * string list list) =
  <span data-count="3">i</span>f check_next_player_done (skip_tur<span data-count="3">n</span> loaded) then <span data-count="1">s</span>kip_turn_try_multiple (skip_tur<span data-count="1">n</span> loaded)
  else <span data-count="2">s</span>kip_turn loaded;;

(* Rest of file is for printing to stdio *)

let intro_string (color: string) : string =
  <span data-count="5">m</span>atch color with 
  | <span data-count="1">"</span>R" -&gt; "\n     It is red's turn!\n     Here are your pieces:\n"
  | <span data-count="1">"</span>Y" -&gt; "\n     It is yellow's turn!\n     Here are your pieces:\n"
  | <span data-count="1">"</span>B" -&gt; "\n     It is blue's turn!\n     Here are your pieces:\n"
  | <span data-count="1">"</span>G" -&gt; "\n     It is green's turn!\n     Here are your pieces:\n"
  | <span data-count="1">_</span> -&gt; "\n     ERROR!\n";;

let rec get_pieces_helper (curr: int) (hand: string list) : string list =
  <span data-count="2">i</span>f String.equal (List.nth_ex<span data-count="2">n</span> hand 0) "\n     ERROR!\n" then <span data-count="0">[</span>]
  else <span data-count="2">i</span>f (curr = List.lengt<span data-count="2">h</span> piecesStrings) then <span data-count="0">[</span>]
  else <span data-count="2">i</span>f (curr = List.lengt<span data-count="2">h</span> hand) then <span data-count="1">[</span>]
  else <span data-count="1">L</span>ist.nth_ex<span data-count="1">n</span> piecesStrings (int_of_strin<span data-count="1">g</span> (List.nth_ex<span data-count="1">n</span> hand curr)) :: get_pieces_helpe<span data-count="1">r</span> (curr + 1) hand;;

let get_pieces  (color: string) (data: string list list) : string list =
  <span data-count="1">g</span>et_pieces_helper 0 (string_list_of_piece<span data-count="1">s</span> color data);;


let combine_strings_with_newline (first: string) (second: string) : string =
  <span data-count="1">f</span>irst ^ "\n" ^ second;;

let player_string (data: string list list): string =
  <span data-count="0">i</span>ntro_strin<span data-count="0">g</span> (List.nth_ex<span data-count="0">n</span> (List.nth_ex<span data-count="0">n</span> data 5) 0) ^ (List.fol<span data-count="0">d</span> ~f:(combine_strings_with_newline) ~init:("") (get_piece<span data-count="0">s</span> (List.nth_ex<span data-count="0">n</span> (List.nth_ex<span data-count="0">n</span> data 5) 0) data));;  


let score_string (data: string list list) : string =
  <span data-count="1">"</span>\nRed score: " ^(List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> data 0) 1) ^ "\n" ^ "Yellow score: " ^(List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> data 1) 1) ^ "\n" ^ "Blue score: " ^(List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> data 2) 1) ^ "\n" ^ "Green score: " ^(List.nth_ex<span data-count="1">n</span> (List.nth_ex<span data-count="1">n</span> data 3) 1) ^ "\n";;

(* Print the current state of the game in state.txt to stdio
  This first prints the board, then whose turn it is, then the pieces of the current playeer
*)  
let print_state (loaded: (string list list * string list list)) =
  <span data-count="0">i</span>f (check_game_over loaded) then <span data-count="0">p</span>rint_endline (board_to_string_stdi<span data-count="0">o</span> (get_secon<span data-count="0">d</span> loaded) ^ "\nGame is over! Lowest score wins!\n" ^ score_strin<span data-count="0">g</span> (get_firs<span data-count="0">t</span> loaded))
  else <span data-count="0">p</span>rint_endline (board_to_string_stdi<span data-count="0">o</span> (get_secon<span data-count="0">d</span> loaded) ^ player_strin<span data-count="0">g</span> (get_firs<span data-count="0">t</span> loaded));;

let game_over_string (over: bool) (pair:(string list list * string list list)): string =
  <span data-count="0">i</span>f over then <span data-count="0">(</span>to_string_file (get_firs<span data-count="0">t</span> pair))
  else <span data-count="0">(</span>(to_string_fil<span data-count="0">e</span> (subse<span data-count="0">t</span> (get_firs<span data-count="0">t</span> pair) 0 3)) ^ (ai_strin<span data-count="0">g</span> (string_of_in<span data-count="0">t</span> (List.lengt<span data-count="0">h</span> (List.nth_ex<span data-count="0">n</span> (get_firs<span data-count="0">t</span> pair) 4)))) ^ "      " ^ (List.nth_ex<span data-count="0">n</span> (List.nth_ex<span data-count="0">n</span> (get_firs<span data-count="0">t</span> pair) 5) 0) ^ "\n"^ (to_string_fil<span data-count="0">e</span> (get_secon<span data-count="0">d</span> pair)));;
    
</code></pre>
      </div>
    </div>
    <script src="../coverage.js"></script>
  </body>
</html>
